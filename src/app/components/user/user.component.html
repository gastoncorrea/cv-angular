<div class="component">
  <div class="title">
    <h4 *ngIf="isEditMode">Editar Usuario</h4>
    <h4 *ngIf="!isEditMode">Crear Usuario</h4>
  </div>

  <form [formGroup]="userForm" (ngSubmit)="onSubmit()" class="user-form">
    <div *ngIf="isLoading">Cargando...</div>
    <div *ngIf="errorMessage" class="error-message">{{ errorMessage }}</div>

    <div class="form-group">
      <label for="email">Email:</label>
      <input type="email" id="email" formControlName="email" placeholder="Ingrese el email">
      <div *ngIf="email?.invalid && (email?.dirty || email?.touched)" class="validation-error">
        <div *ngIf="email?.errors?.['required']">El email es requerido.</div>
        <div *ngIf="email?.errors?.['email']">El email no es válido.</div>
      </div>
    </div>

    <div class="form-group">
      <label for="nombre">Nombre:</label>
      <input type="text" id="nombre" formControlName="nombre" placeholder="Ingrese el nombre">
      <div *ngIf="nombre?.invalid && (nombre?.dirty || nombre?.touched)" class="validation-error">
        <div *ngIf="nombre?.errors?.['required']">El nombre es requerido.</div>
        <div *ngIf="nombre?.errors?.['minlength']">El nombre debe tener al menos 3 caracteres.</div>
        <div *ngIf="nombre?.errors?.['maxlength']">El nombre no debe exceder los 40 caracteres.</div>
      </div>
    </div>

    <div class="form-group">
      <label for="password">Contraseña:</label>
      <input type="password" id="password" formControlName="password" placeholder="Ingrese la contraseña" autocomplete="new-password">
      <div *ngIf="password?.invalid && (password?.dirty || password?.touched)" class="validation-error">
        <div *ngIf="password?.errors?.['required']">La contraseña es requerida.</div>
        <div *ngIf="password?.errors?.['minlength']">La contraseña debe tener al menos 8 caracteres.</div>
        <div *ngIf="password?.errors?.['maxlength']">La contraseña no debe exceder los 200 caracteres.</div>
      </div>
    </div>

    <button type="submit" [disabled]="userForm.invalid || isLoading">
      {{ isEditMode ? 'Actualizar' : 'Crear' }} Usuario
    </button>
    <!-- Add a cancel button or routerLink back -->
    <button type="button" (click)="userForm.reset()">Cancelar</button>
  </form>
</div>
